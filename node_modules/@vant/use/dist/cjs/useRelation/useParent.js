"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

exports.__esModule = true;
exports.useParent = useParent;

var _objectWithoutPropertiesLoose2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutPropertiesLoose"));

var _vue = require("vue");

function useParent(key) {
  var parent = (0, _vue.inject)(key, null);

  if (parent) {
    var instance = (0, _vue.getCurrentInstance)();

    if (instance) {
      var _link = parent.link,
          _unlink = parent.unlink,
          internalChildren = parent.internalChildren,
          rest = (0, _objectWithoutPropertiesLoose2.default)(parent, ["link", "unlink", "internalChildren"]);

      _link(instance);

      (0, _vue.onUnmounted)(function () {
        _unlink(instance);
      });
      var index = (0, _vue.computed)(function () {
        return internalChildren.indexOf(instance);
      });
      return {
        parent: rest,
        index: index
      };
    }
  }

  return {};
}